(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[727],{6582:function(e,t,a){Promise.resolve().then(a.bind(a,2767))},2767:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var s=a(7437),l=a(2265),r=a(301),o=a(6463),n=a(1942),i=a(7847),c=a(510),d=a(4524),u=a(2399),g=a(9676);let h=[{name:"orange",bgClass:"bg-orange",textClass:"text-gray-200",borderClass:"border-orange",highlightClass:"text-orange",buttonBgClass:"bg-gray-700",cardCoverBgClass:"from-bgOrange"},{name:"blue",bgClass:"bg-blue-500",textClass:"text-white",borderClass:"border-blue-500",highlightClass:"text-blue-500",buttonBgClass:"bg-gray-700",cardCoverBgClass:"from-bgBlue"},{name:"purple",bgClass:"bg-purple-500",textClass:"text-white",borderClass:"border-purple-500",highlightClass:"text-purple-500",buttonBgClass:"bg-gray-700",cardCoverBgClass:"from-bgViolet"},{name:"green",bgClass:"bg-green-500",textClass:"text-white",borderClass:"border-green-500",highlightClass:"text-green-500",buttonBgClass:"bg-gray-700",cardCoverBgClass:"from-bgGreen "},{name:"yellow",bgClass:"bg-yellow-400",textClass:"text-white",borderClass:"border-yellow-400",highlightClass:"text-yellow-400",buttonBgClass:"bg-gray-700",cardCoverBgClass:"from-bgYellow"},{name:"teal",bgClass:"bg-teal-400",textClass:"text-white",borderClass:"border-teal-400",highlightClass:"text-teal-400",buttonBgClass:"bg-gray-700",cardCoverBgClass:"from-bgTeal"}],m=async(e,t,a)=>{try{if(!(await fetch("".concat(u.M,"/api/profile/saveColor"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,selectedColor:t})})).ok)throw Error("Failed to save selected color");a("Color saved successfully","Success","green")}catch(e){console.error(e),a("Failed to save color","Error","red")}},x=async(e,t,a,s)=>{a(!0);try{console.log("".concat(u.M,"/api/profile/").concat(e));let a=await fetch("".concat(u.M,"/api/profile/").concat(e));if(!a.ok)throw Error("Failed to fetch user data");let s=await a.json();t(s)}catch(e){console.error(e),s("Failed to load profile","Error","red")}finally{a(!1)}},b=()=>{let{user:e}=(0,c.a)(),[t,a]=(0,l.useState)(null),[b,p]=(0,l.useState)(!1),[v,w]=(0,l.useState)(null),[j,N]=(0,l.useState)(h[0]),[E,S]=(0,l.useState)(null),[O,k]=(0,l.useState)(!1),[B,T]=(0,l.useState)(!1);(0,o.useRouter)();let L=(0,o.useSearchParams)(),R=null==L?void 0:L.get("id"),P=()=>{T(!0)},I=()=>{T(!1)},z=async e=>{try{await fetch("".concat(u.M,"/api/profile/exchangeContact"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({vCard:e})})}catch(e){console.error("Error sending contact information:",e)}};(0,l.useEffect)(()=>{R&&x(R,a,p,V)},[R]),(0,l.useEffect)(()=>{if(t&&t.selectedColor){let e=h.find(e=>e.name===t.selectedColor);e&&N(e)}},[t]),(0,l.useEffect)(()=>{let e=()=>{k(window.innerWidth<=768)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]);let V=(e,t,a)=>{w({message:e,title:t,color:a}),setTimeout(()=>w(null),4e3)},F=()=>{if(!t)return;let e=["BEGIN:VCARD","VERSION:3.0","CLASS:PUBLIC","PRODID:-//class_vcard //NONSGML Version 1//EN"];t.lastName&&t.firstName&&e.push("N:".concat(t.lastName,";").concat(t.firstName,";;;")),t.name&&e.push("FN:".concat(t.name)),t.image&&e.push("PHOTO;ENCODING=b;TYPE=JPEG|PNG:".concat(t.image)),t.phone1&&e.push("TEL;TYPE=Phone,type=VOICE;type=pref:".concat(t.phone1)),t.phone2&&e.push("TEL;type=Phone;type=VOICE:".concat(t.phone2)),t.email&&e.push("EMAIL;type=INTERNET;type=Email;type=pref:".concat(t.email)),t.email2&&e.push("EMAIL;type=INTERNET;type=Email 2:".concat(t.email2));let a=[t.street1||"",t.city||"",t.state||"",t.zipCode||"",t.country||""].filter(Boolean).join(";");e.push("ADR;type=WORK;type=pref:;;".concat(a)),t.website&&e.push("URL;type=Website;type=pref:".concat(t.website)),t.bio&&e.push("NOTE;CHARSET=UTF-8:".concat(t.bio)),e.push("REV:".concat(new Date().toISOString().replace(/[-:.]/g,"").slice(0,15),"Z")),e.push("END:VCARD");let s=new Blob([e.join("\r\n")],{type:"text/vcard"}),l=URL.createObjectURL(s),r=document.createElement("a");r.href=l,r.download="".concat(t.firstName,"_").concat(t.lastName,".vcf"),r.click(),URL.revokeObjectURL(l)};return!t||b?(0,s.jsx)("div",{className:"flex justify-center items-center py-72",children:(0,s.jsx)("img",{src:"/load.gif",alt:"Loading...",className:"w-40 h-40"})}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center ".concat(j.textClass),style:{backgroundImage:"\n                    linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7))",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",boxShadow:"0px 20px 50px rgba(0, 0, 0, 0.8)"},children:(0,s.jsxs)(i.E.div,{className:"relative z-10 w-full pt-40 max-w-md p-8 rounded-lg bg-gradient-to-b ".concat(j.cardCoverBgClass," to-black   bg-opacity-5 shadow-2xl"),style:{borderRadius:"inherit"},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},children:[(0,s.jsx)(f,{user:t,cardStyle:j}),(0,s.jsx)(i.E.div,{className:"mt-6",initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{duration:.6,ease:"easeOut"},children:(0,s.jsx)(d.Z,{user:t})}),(0,s.jsx)(i.E.div,{className:"mt-6",initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{duration:.6,ease:"easeOut"},children:(0,s.jsx)(g.Z,{user:t,cardStyle:j})}),(0,s.jsx)(e=>{let{generateVCF:t}=e;return(0,s.jsxs)("div",{className:"fixed bottom-6 left-0 right-0 px-4 z-20 flex justify-center space-x-4 max-w-screen-md mx-auto",children:[(0,s.jsxs)("button",{onClick:t,className:"flex-grow flex items-center justify-center bg-gradient-to-r from-red-600 to-red-700 text-white py-3 rounded-full shadow-lg hover:shadow-xl hover:bg-red-900 transition-all duration-300 ease-in-out transform hover:scale-105",children:[(0,s.jsx)(n.aBF,{className:"mr-2 text-3xl"}),(0,s.jsx)("span",{className:"text-lg font-semibold",children:"СВАЛИ КОНТАКТ"})]}),(0,s.jsx)("button",{onClick:P,className:"w-16 flex items-center justify-center bg-gradient-to-r from-green-500 to-green-700 text-white py-3 rounded-full shadow-lg hover:shadow-xl hover:bg-green-600 transition-all duration-300 ease-in-out transform hover:scale-105",children:(0,s.jsx)(n.qau,{className:"text-3xl"})}),(0,s.jsx)(r.Z,{isOpen:B,onClose:I,onSubmit:z})]})},{generateVCF:F}),(null==e?void 0:e.id)===t.id&&(0,s.jsx)(i.E.div,{className:"mt-8",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.6,ease:"easeOut",delay:.6},children:(0,s.jsx)(y,{cardBackgroundOptions:h,handleColorSelection:e=>{if(t&&t.id){m(t.id,e,V);let a=h.find(t=>t.name===e);a&&N(a)}},cardStyle:j})}),(0,s.jsx)(i.E.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.8,ease:"easeOut",delay:.8},children:(0,s.jsx)(C,{user:t,showTooltip:E,handleTouchStart:e=>{setTimeout(()=>S(e),500)},handleTouchEnd:()=>{S(null)},generateVCF:F,shareContact:()=>{navigator.share?navigator.share({title:(null==t?void 0:t.name)?"Контакт ".concat(t.name):"Контакт",text:(null==t?void 0:t.name)?"Вижте контактните данни на ".concat(t.name):"Вижте контактните данни",url:window.location.href}):F()}})})]})})};function p(){return(0,s.jsx)(l.Suspense,{fallback:(0,s.jsx)("div",{children:"Loading..."}),children:(0,s.jsx)(b,{})})}let f=e=>{let{user:t,cardStyle:a}=e;return(0,s.jsxs)("div",{className:"relative flex items-center p-4 bg-gradient-to-b ".concat(a.cardCoverBgClass," to-black rounded-lg shadow-lg"),children:[(0,s.jsx)(i.E.div,{className:"relative z-10 w-80 h-52 rounded-full overflow-hidden border-4 ".concat(a.borderClass," shadow-xl"),initial:{scale:.9},animate:{scale:1},whileHover:{scale:1.05},transition:{duration:.5},children:(null==t?void 0:t.image)?(0,s.jsx)("img",{className:"w-full h-full object-cover",src:"data:image/jpeg;base64,".concat(t.image),alt:"Profile"}):(0,s.jsx)(n.m3W,{className:"w-full h-full text-gray-300"})}),(0,s.jsxs)("div",{className:"ml-4 z-10",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-white leading-tight",children:null==t?void 0:t.name}),(0,s.jsx)("p",{className:"text-md mt-2 ".concat(a.highlightClass),children:null==t?void 0:t.position}),(0,s.jsx)("p",{className:"text-md mt-0 ".concat(a.highlightClass),children:null==t?void 0:t.company}),(null==t?void 0:t.bio)&&(0,s.jsx)("p",{className:"text-sm mt-3 text-gray-300 max-w-xs leading-relaxed",children:t.bio.length>120?"".concat(t.bio.substring(0,117),"..."):t.bio})]})]})},C=e=>{let{user:t,showTooltip:a,handleTouchStart:l,handleTouchEnd:r,generateVCF:o,shareContact:n}=e;return(0,s.jsx)("div",{className:"fixed bottom-4 left-5 right-5 flex justify-center items-center space-x-8 z-20"})},y=e=>{let{cardBackgroundOptions:t,handleColorSelection:a,cardStyle:l}=e;return(0,s.jsxs)("div",{className:"mt-6 text-center",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold ".concat(l.highlightClass),children:"Customize Card Background"}),(0,s.jsx)("div",{className:"flex justify-center space-x-4 mt-4",children:t.map(e=>{let{name:t,bgClass:r}=e;return(0,s.jsx)("button",{onClick:()=>a(t),"aria-label":"Select ".concat(t," background"),className:"w-10 h-10 rounded-full border-2 transition-transform transform hover:scale-110 ".concat(r," ").concat(l.name===t?"ring-4 ring-offset-2 ring-blue-500":""),children:l.name===t&&(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-4 h-4 text-white mx-auto",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})},t)})})]})}}},function(e){e.O(0,[699,595,847,691,971,23,744],function(){return e(e.s=6582)}),_N_E=e.O()}]);